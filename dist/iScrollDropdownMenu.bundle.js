!function(t){function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var e={};n.m=t,n.c=e,n.i=function(t){return t},n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=5)}([function(t,n,e){"use strict";function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}();!function(t){var n="iScrollDropdownMenu",e=t.fn[n],s={startAtItem:0},a=function(){function n(e,o){i(this,n),this.config=this._getConfig(o),this.element=e,this.$element=t(this.element),this.$scroller=this.$element.find(".scroller"),this.iScroll,this.$ul=this.$scroller.find("> ul"),this.$items=this.$ul.find(">li"),this.$itemsDropdowns=this.$items.filter(".dropdown"),this.$dropdownMenus=this.$itemsDropdowns.find(".dropdown-menu"),this.$dropdownMenusWrapper,this.$startItem=this.$ul.find("li:eq("+this.config.startAtItem+")"),this.$indicator=this.$element.find(".indicator"),this.init()}return r(n,[{key:"init",value:function(){var n=this;this.$itemsDropdowns.each(function(){var n="item"+t(this).index();t(this).data("id",n).attr("data-id",n),t(this).find(".dropdown-menu").data("parent",n).attr("data-id",n)}),this.$dropdownMenusWrapper=t('<div class="iScrollDropdownMenu-dropdowns"></div>'),this.$element.after(this.$dropdownMenusWrapper),this.$dropdownMenusWrapper.append(this.$dropdownMenus),this.$dropdownMenus.find("[data-toggle=close]").each(function(){t(this).on("click",function(){t(this).closest(".dropdown-menu").slideUp()})}),setTimeout(function(){n.$scroller.width(n.getItemsWidth()),n.iScroll=new IScroll(n.element,{eventPassthrough:!0,scrollX:!0,scrollY:!1,preventDefault:!1,bounceEasing:"quadratic",snap:!1}),n.iScroll.scrollToElement(n.$startItem.get(0),125),n.toggleIndicator(),t(window).on("resize",function(){n.toggleIndicator()}),n.indicatorLoopAnimation(10,500),n.iScroll.on("scrollStart",function(){n.$indicator.fadeOut()})},500),this.$items.on("click",function(){t(this).find("> a").trigger("click")}),this.$items.find("> a").on("click",function(e){e.preventDefault(),e.stopPropagation(),n.$dropdownMenusWrapper.find("div").hide();var i=t(this).parent("li");if(n.iScroll.scrollToElement(i.get(0),500),n.$items.removeClass("beforeActive"),n.$items.not(i).removeClass("active"),i.prev().addClass("beforeActive"),i.addClass("active"),i.hasClass("dropdown")){var o=i.data("id");n.$dropdownMenusWrapper.find("div[data-id="+o+"]").slideDown()}else location.href=this.href})}},{key:"toggleIndicator",value:function(){this.iScroll.hasHorizontalScroll?this.$indicator.show():this.$indicator.hide()}},{key:"indicatorLoopAnimation",value:function(n,e){var i=this;this.$indicator.find(".fa").animate({right:"+="+n},e,function(){t(this).animate({right:"-="+n},e,function(){i.indicatorLoopAnimation(n,e)})})}},{key:"getItemsWidth",value:function(){var n=0;return this.$items.each(function(){n+=t(this).outerWidth()}),n}},{key:"_getConfig",value:function(n){return n=t.extend({},s,n)}}],[{key:"_jQueryInterface",value:function(e){return this.each(function(){var i=t(this),r=i.data("iScrollDropdownMenu"),a=t.extend({},s,i.data(),"object"===(void 0===e?"undefined":o(e))&&e);if(!r&&/dispose/.test(e)&&this.dispose(),r||(r=new n(this,a),i.data("iScrollDropdownMenu",r)),"string"==typeof e){if(void 0===r[e])throw new Error('No method named "'+e+'"');r[e]()}})}}]),n}();t.fn[n]=a._jQueryInterface,t.fn[n].Constructor=a,t.fn[n].noConflict=function(){return t.fn[n]=e,a._jQueryInterface}}(jQuery)},function(t,n,e){t.exports=e.p+"demo-basic.css"},function(t,n,e){t.exports=e.p+"demo-intralignes.css"},function(t,n,e){t.exports=e.p+"demo-rh.css"},function(t,n,e){t.exports=e.p+"iScrollDropdownMenu.css"},function(t,n,e){e(0),e(4),e(1),e(2),t.exports=e(3)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vaVNjcm9sbERyb3Bkb3duTWVudS5idW5kbGUuanMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIGZmNWNjODRkYzZjNzRkZDQ1ZGYyIiwid2VicGFjazovLy8uL3NyYy9pU2Nyb2xsRHJvcGRvd25NZW51LmpzIiwid2VicGFjazovLy8uL3NyYy9kZW1vLWJhc2ljLnNjc3MiLCJ3ZWJwYWNrOi8vLy4vc3JjL2RlbW8taW50cmFsaWduZXMuc2NzcyIsIndlYnBhY2s6Ly8vLi9zcmMvZGVtby1yaC5zY3NzIiwid2VicGFjazovLy8uL3NyYy9pU2Nyb2xsRHJvcGRvd25NZW51LnNjc3MiXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJjYWxsIiwibSIsImMiLCJ2YWx1ZSIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiY29uZmlndXJhYmxlIiwiZW51bWVyYWJsZSIsImdldCIsIm4iLCJfX2VzTW9kdWxlIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIl90eXBlb2YiLCJTeW1ib2wiLCJpdGVyYXRvciIsIm9iaiIsImNvbnN0cnVjdG9yIiwiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwibGVuZ3RoIiwiZGVzY3JpcHRvciIsIndyaXRhYmxlIiwia2V5IiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwiJCIsIk5BTUUiLCJKUVVFUllfTk9fQ09ORkxJQ1QiLCJmbiIsImRlZmF1bHRzIiwic3RhcnRBdEl0ZW0iLCJpU2Nyb2xsRHJvcGRvd25NZW51IiwiZWxlbWVudCIsImNvbmZpZyIsInRoaXMiLCJfZ2V0Q29uZmlnIiwiJGVsZW1lbnQiLCIkc2Nyb2xsZXIiLCJmaW5kIiwiaVNjcm9sbCIsIiR1bCIsIiRpdGVtcyIsIiRpdGVtc0Ryb3Bkb3ducyIsImZpbHRlciIsIiRkcm9wZG93bk1lbnVzIiwiJGRyb3Bkb3duTWVudXNXcmFwcGVyIiwiJHN0YXJ0SXRlbSIsIiRpbmRpY2F0b3IiLCJpbml0Iiwic2VsZiIsImVhY2giLCJpdGVtSWQiLCJpbmRleCIsImRhdGEiLCJhdHRyIiwiYWZ0ZXIiLCJhcHBlbmQiLCJvbiIsImNsb3Nlc3QiLCJzbGlkZVVwIiwic2V0VGltZW91dCIsIndpZHRoIiwiZ2V0SXRlbXNXaWR0aCIsIklTY3JvbGwiLCJldmVudFBhc3N0aHJvdWdoIiwic2Nyb2xsWCIsInNjcm9sbFkiLCJwcmV2ZW50RGVmYXVsdCIsImJvdW5jZUVhc2luZyIsInNuYXAiLCJzY3JvbGxUb0VsZW1lbnQiLCJ0b2dnbGVJbmRpY2F0b3IiLCJ3aW5kb3ciLCJpbmRpY2F0b3JMb29wQW5pbWF0aW9uIiwiZmFkZU91dCIsInRyaWdnZXIiLCJlIiwic3RvcFByb3BhZ2F0aW9uIiwiaGlkZSIsIiRsaVBhcmVudCIsInBhcmVudCIsInJlbW92ZUNsYXNzIiwibm90IiwicHJldiIsImFkZENsYXNzIiwiaGFzQ2xhc3MiLCJzbGlkZURvd24iLCJsb2NhdGlvbiIsImhyZWYiLCJoYXNIb3Jpem9udGFsU2Nyb2xsIiwic2hvdyIsIm9mZnNldCIsImR1cmF0aW9uIiwiYW5pbWF0ZSIsInJpZ2h0IiwiaXRlbXNXaWR0aCIsIm91dGVyV2lkdGgiLCJleHRlbmQiLCIkdGhpcyIsIl9raWtvbyIsInRlc3QiLCJkaXNwb3NlIiwidW5kZWZpbmVkIiwiRXJyb3IiLCJfalF1ZXJ5SW50ZXJmYWNlIiwibm9Db25mbGljdCIsImpRdWVyeSJdLCJtYXBwaW5ncyI6IkNBQVMsU0FBVUEsR0NJbkIsUUFBQUMsR0FBQUMsR0FHQSxHQUFBQyxFQUFBRCxHQUNBLE1BQUFDLEdBQUFELEdB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QU03QyxPQUNZLGdCQUFsQixLQUFPcEIsRUFBUCxZQUFBdkIsRUFBT3VCLEtBQXVCQSxFQVlsQyxLQVRLb0IsR0FBUSxVQUFVK0MsS0FBS25FLElBQ3hCQyxLQUFLbUUsVUFHSmhELElBQ0RBLEVBQU8sR0FBSXRCLEdBQW9CRyxLQUFNaUUsR0FDckNELEVBQU03QyxLQTlJTCxzQkE4SW9CQSxJQUdILGdCQUFYcEIsR0FBcUIsQ0FDNUIsT0FBcUJxRSxLQUFqQmpELEVBQUtwQixHQUNMLEtBQU0sSUFBSXNFLE9BQUosb0JBQThCdEUsRUFBOUIsSUFFVm9CLEdBQUtwQixZQXhKV0YsSUFvS2hDTixHQUFFRyxHQUFHRixHQUFRSyxFQUFvQnlFLGlCQUNqQy9FLEVBQUVHLEdBQUdGLEdBQU1sQixZQUFjdUIsRUFDekJOLEVBQUVHLEdBQUdGLEdBQU0rRSxXQUFhLFdBRXBCLE1BREFoRixHQUFFRyxHQUFHRixHQUFRQyxFQUNOSSxFQUFvQnlFLG1CQUdoQ0UsU0Y0RkcsU0FBVTVILEVBQVFELEVBQVNILEdHdlFqQ0ksRUFBQUQsUUFBQUgsRUFBQTBCLEVBQUEsa0JINlFNLFNBQVV0QixFQUFRRCxFQUFTSCxHSTdRakNJLEVBQUFELFFBQUFILEVBQUEwQixFQUFBLHdCSm1STSxTQUFVdEIsRUFBUUQsRUFBU0gsR0tuUmpDSSxFQUFBRCxRQUFBSCxFQUFBMEIsRUFBQSxlTHlSTSxTQUFVdEIsRUFBUUQsRUFBU0gsR016UmpDSSxFQUFBRCxRQUFBSCxFQUFBMEIsRUFBQSwyQk4rUk0sU0FBVXRCLEVBQVFELEVBQVNILEdBRWpDQSxFQUFvQixHQUNwQkEsRUFBb0IsR0FDcEJBLEVBQW9CLEdBQ3BCQSxFQUFvQixHQUNwQkksRUFBT0QsUUFBVUgsRUFBb0IiLCJmaWxlIjoiaVNjcm9sbERyb3Bkb3duTWVudS5idW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi8gXHRcdH1cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGk6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bDogZmFsc2UsXG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gaWRlbnRpdHkgZnVuY3Rpb24gZm9yIGNhbGxpbmcgaGFybW9ueSBpbXBvcnRzIHdpdGggdGhlIGNvcnJlY3QgY29udGV4dFxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmkgPSBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gdmFsdWU7IH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4vKioqKioqLyBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuLyoqKioqKi8gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbi8qKioqKiovIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbi8qKioqKiovIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbi8qKioqKiovIFx0XHRcdH0pO1xuLyoqKioqKi8gXHRcdH1cbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuLyoqKioqKi8gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbi8qKioqKiovIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4vKioqKioqLyBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuLyoqKioqKi8gXHRcdHJldHVybiBnZXR0ZXI7XG4vKioqKioqLyBcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSA1KTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cblxudmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgaVNjcm9sbERyb3Bkb3duTWVudSA9IGZ1bmN0aW9uICgkKSB7XG5cbiAgICB2YXIgTkFNRSA9ICdpU2Nyb2xsRHJvcGRvd25NZW51JztcbiAgICB2YXIgREFUQV9LRVkgPSAnaVNjcm9sbERyb3Bkb3duTWVudSc7XG4gICAgdmFyIEpRVUVSWV9OT19DT05GTElDVCA9ICQuZm5bTkFNRV07XG5cbiAgICB2YXIgZGVmYXVsdHMgPSB7XG4gICAgICAgIHN0YXJ0QXRJdGVtOiAwXG4gICAgfTtcblxuICAgIHZhciBpU2Nyb2xsRHJvcGRvd25NZW51ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBpU2Nyb2xsRHJvcGRvd25NZW51KGVsZW1lbnQsIGNvbmZpZykge1xuICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIGlTY3JvbGxEcm9wZG93bk1lbnUpO1xuXG4gICAgICAgICAgICB0aGlzLmNvbmZpZyA9IHRoaXMuX2dldENvbmZpZyhjb25maWcpO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgICAgIHRoaXMuJGVsZW1lbnQgPSAkKHRoaXMuZWxlbWVudCk7XG4gICAgICAgICAgICB0aGlzLiRzY3JvbGxlciA9IHRoaXMuJGVsZW1lbnQuZmluZCgnLnNjcm9sbGVyJyk7XG4gICAgICAgICAgICB0aGlzLmlTY3JvbGw7XG4gICAgICAgICAgICB0aGlzLiR1bCA9IHRoaXMuJHNjcm9sbGVyLmZpbmQoJz4gdWwnKTtcbiAgICAgICAgICAgIHRoaXMuJGl0ZW1zID0gdGhpcy4kdWwuZmluZCgnPmxpJyk7XG4gICAgICAgICAgICB0aGlzLiRpdGVtc0Ryb3Bkb3ducyA9IHRoaXMuJGl0ZW1zLmZpbHRlcignLmRyb3Bkb3duJyk7XG4gICAgICAgICAgICB0aGlzLiRkcm9wZG93bk1lbnVzID0gdGhpcy4kaXRlbXNEcm9wZG93bnMuZmluZCgnLmRyb3Bkb3duLW1lbnUnKTtcbiAgICAgICAgICAgIHRoaXMuJGRyb3Bkb3duTWVudXNXcmFwcGVyO1xuICAgICAgICAgICAgdGhpcy4kc3RhcnRJdGVtID0gdGhpcy4kdWwuZmluZCgnbGk6ZXEoJyArIHRoaXMuY29uZmlnLnN0YXJ0QXRJdGVtICsgJyknKTtcbiAgICAgICAgICAgIHRoaXMuJGluZGljYXRvciA9IHRoaXMuJGVsZW1lbnQuZmluZCgnLmluZGljYXRvcicpO1xuXG4gICAgICAgICAgICB0aGlzLmluaXQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIF9jcmVhdGVDbGFzcyhpU2Nyb2xsRHJvcGRvd25NZW51LCBbe1xuICAgICAgICAgICAga2V5OiAnaW5pdCcsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdCgpIHtcblxuICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgICAgIHRoaXMuJGl0ZW1zRHJvcGRvd25zLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbUlkID0gJ2l0ZW0nICsgJCh0aGlzKS5pbmRleCgpO1xuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmRhdGEoJ2lkJywgaXRlbUlkKS5hdHRyKCdkYXRhLWlkJywgaXRlbUlkKTtcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5maW5kKCcuZHJvcGRvd24tbWVudScpLmRhdGEoJ3BhcmVudCcsIGl0ZW1JZCkuYXR0cignZGF0YS1pZCcsIGl0ZW1JZCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy4kZHJvcGRvd25NZW51c1dyYXBwZXIgPSAkKCc8ZGl2IGNsYXNzPVwiaVNjcm9sbERyb3Bkb3duTWVudS1kcm9wZG93bnNcIj48L2Rpdj4nKTtcbiAgICAgICAgICAgICAgICB0aGlzLiRlbGVtZW50LmFmdGVyKHRoaXMuJGRyb3Bkb3duTWVudXNXcmFwcGVyKTtcbiAgICAgICAgICAgICAgICB0aGlzLiRkcm9wZG93bk1lbnVzV3JhcHBlci5hcHBlbmQodGhpcy4kZHJvcGRvd25NZW51cyk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLiRkcm9wZG93bk1lbnVzLmZpbmQoJ1tkYXRhLXRvZ2dsZT1jbG9zZV0nKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmNsb3Nlc3QoJy5kcm9wZG93bi1tZW51Jykuc2xpZGVVcCgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIFRpbWVvdXQgcmVxdWlyZWQgdG8gYXZvaWQgYnVncyB3aXRoIGlTY3JvbGwgbGF0ZSBpbml0aWFsaXphdGlvbi4uLlxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLiRzY3JvbGxlci53aWR0aChzZWxmLmdldEl0ZW1zV2lkdGgoKSk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaVNjcm9sbCA9IG5ldyBJU2Nyb2xsKHNlbGYuZWxlbWVudCwge1xuICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRQYXNzdGhyb3VnaDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFg6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxZOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZlbnREZWZhdWx0OiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvdW5jZUVhc2luZzogJ3F1YWRyYXRpYycsXG4gICAgICAgICAgICAgICAgICAgICAgICBzbmFwOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5pU2Nyb2xsLnNjcm9sbFRvRWxlbWVudChzZWxmLiRzdGFydEl0ZW0uZ2V0KDApLCAxMjUpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnRvZ2dsZUluZGljYXRvcigpO1xuICAgICAgICAgICAgICAgICAgICAkKHdpbmRvdykub24oJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYudG9nZ2xlSW5kaWNhdG9yKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaW5kaWNhdG9yTG9vcEFuaW1hdGlvbigxMCwgNTAwKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5pU2Nyb2xsLm9uKCdzY3JvbGxTdGFydCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuJGluZGljYXRvci5mYWRlT3V0KCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0sIDUwMCk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLiRpdGVtcy5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICQodGhpcykuZmluZCgnPiBhJykudHJpZ2dlcignY2xpY2snKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLiRpdGVtcy5maW5kKCc+IGEnKS5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuJGRyb3Bkb3duTWVudXNXcmFwcGVyLmZpbmQoJ2RpdicpLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyICRsaVBhcmVudCA9ICQodGhpcykucGFyZW50KCdsaScpO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmlTY3JvbGwuc2Nyb2xsVG9FbGVtZW50KCRsaVBhcmVudC5nZXQoMCksIDUwMCk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuJGl0ZW1zLnJlbW92ZUNsYXNzKCdiZWZvcmVBY3RpdmUnKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi4kaXRlbXMubm90KCRsaVBhcmVudCkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgICAgICAkbGlQYXJlbnQucHJldigpLmFkZENsYXNzKCdiZWZvcmVBY3RpdmUnKTtcbiAgICAgICAgICAgICAgICAgICAgJGxpUGFyZW50LmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRsaVBhcmVudC5oYXNDbGFzcygnZHJvcGRvd24nKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1JZCA9ICRsaVBhcmVudC5kYXRhKCdpZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi4kZHJvcGRvd25NZW51c1dyYXBwZXIuZmluZCgnZGl2W2RhdGEtaWQ9JyArIGl0ZW1JZCArICddJykuc2xpZGVEb3duKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gdGhpcy5ocmVmO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ3RvZ2dsZUluZGljYXRvcicsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdG9nZ2xlSW5kaWNhdG9yKCkge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5pU2Nyb2xsLmhhc0hvcml6b250YWxTY3JvbGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy4kaW5kaWNhdG9yLmhpZGUoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLiRpbmRpY2F0b3Iuc2hvdygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwge1xuICAgICAgICAgICAga2V5OiAnaW5kaWNhdG9yTG9vcEFuaW1hdGlvbicsXG4gICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5kaWNhdG9yTG9vcEFuaW1hdGlvbihvZmZzZXQsIGR1cmF0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHRoaXMuJGluZGljYXRvci5maW5kKCcuZmEnKS5hbmltYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgcmlnaHQ6ICcrPScgKyBvZmZzZXRcbiAgICAgICAgICAgICAgICB9LCBkdXJhdGlvbiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmFuaW1hdGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQ6ICctPScgKyBvZmZzZXRcbiAgICAgICAgICAgICAgICAgICAgfSwgZHVyYXRpb24sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuaW5kaWNhdG9yTG9vcEFuaW1hdGlvbihvZmZzZXQsIGR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGtleTogJ2dldEl0ZW1zV2lkdGgnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEl0ZW1zV2lkdGgoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGl0ZW1zV2lkdGggPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMuJGl0ZW1zLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpdGVtc1dpZHRoICs9ICQodGhpcykub3V0ZXJXaWR0aCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtc1dpZHRoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBrZXk6ICdfZ2V0Q29uZmlnJyxcbiAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0Q29uZmlnKGNvbmZpZykge1xuICAgICAgICAgICAgICAgIGNvbmZpZyA9ICQuZXh0ZW5kKHt9LCBkZWZhdWx0cywgY29uZmlnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XSwgW3tcbiAgICAgICAgICAgIGtleTogJ19qUXVlcnlJbnRlcmZhY2UnLFxuICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9qUXVlcnlJbnRlcmZhY2UoY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciAkdGhpcyA9ICQodGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gJHRoaXMuZGF0YShEQVRBX0tFWSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfa2lrb28gPSAkLmV4dGVuZCh7fSwgZGVmYXVsdHMsICR0aGlzLmRhdGEoKSwgKHR5cGVvZiBjb25maWcgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKGNvbmZpZykpID09PSAnb2JqZWN0JyAmJiBjb25maWcpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICghZGF0YSAmJiAvZGlzcG9zZS8udGVzdChjb25maWcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICghZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YSA9IG5ldyBpU2Nyb2xsRHJvcGRvd25NZW51KHRoaXMsIF9raWtvbyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy5kYXRhKERBVEFfS0VZLCBkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgY29uZmlnID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGFbY29uZmlnXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBtZXRob2QgbmFtZWQgXCInICsgY29uZmlnICsgJ1wiJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhW2NvbmZpZ10oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XSk7XG5cbiAgICAgICAgcmV0dXJuIGlTY3JvbGxEcm9wZG93bk1lbnU7XG4gICAgfSgpO1xuXG4gICAgLyoqXG4gICAgICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICogalF1ZXJ5XG4gICAgICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICovXG5cbiAgICAkLmZuW05BTUVdID0gaVNjcm9sbERyb3Bkb3duTWVudS5falF1ZXJ5SW50ZXJmYWNlO1xuICAgICQuZm5bTkFNRV0uQ29uc3RydWN0b3IgPSBpU2Nyb2xsRHJvcGRvd25NZW51O1xuICAgICQuZm5bTkFNRV0ubm9Db25mbGljdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJC5mbltOQU1FXSA9IEpRVUVSWV9OT19DT05GTElDVDtcbiAgICAgICAgcmV0dXJuIGlTY3JvbGxEcm9wZG93bk1lbnUuX2pRdWVyeUludGVyZmFjZTtcbiAgICB9O1xuICAgIHJldHVybiBpU2Nyb2xsRHJvcGRvd25NZW51O1xufShqUXVlcnkpO1xuXG4vKioqLyB9KSxcbi8qIDEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxubW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLnAgKyBcImRlbW8tYmFzaWMuY3NzXCI7XG5cbi8qKiovIH0pLFxuLyogMiAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5tb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19yZXF1aXJlX18ucCArIFwiZGVtby1pbnRyYWxpZ25lcy5jc3NcIjtcblxuLyoqKi8gfSksXG4vKiAzICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cbm1vZHVsZS5leHBvcnRzID0gX193ZWJwYWNrX3JlcXVpcmVfXy5wICsgXCJkZW1vLXJoLmNzc1wiO1xuXG4vKioqLyB9KSxcbi8qIDQgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxubW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLnAgKyBcImlTY3JvbGxEcm9wZG93bk1lbnUuY3NzXCI7XG5cbi8qKiovIH0pLFxuLyogNSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5fX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuX193ZWJwYWNrX3JlcXVpcmVfXyg0KTtcbl9fd2VicGFja19yZXF1aXJlX18oMSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xubW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xuXG5cbi8qKiovIH0pXG4vKioqKioqLyBdKTtcblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gaVNjcm9sbERyb3Bkb3duTWVudS5idW5kbGUuanMiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0XG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmkgPSBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gdmFsdWU7IH07XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDUpO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svYm9vdHN0cmFwIGZmNWNjODRkYzZjNzRkZDQ1ZGYyIiwiY29uc3QgaVNjcm9sbERyb3Bkb3duTWVudSA9ICgoJCkgPT4ge1xuXG4gICAgY29uc3QgTkFNRSA9ICdpU2Nyb2xsRHJvcGRvd25NZW51JztcbiAgICBjb25zdCBEQVRBX0tFWSA9ICdpU2Nyb2xsRHJvcGRvd25NZW51JztcbiAgICBjb25zdCBKUVVFUllfTk9fQ09ORkxJQ1QgPSAkLmZuW05BTUVdO1xuXG4gICAgY29uc3QgZGVmYXVsdHMgPSB7XG4gICAgICAgIHN0YXJ0QXRJdGVtOiAwLFxuICAgIH07XG5cbiAgICBjbGFzcyBpU2Nyb2xsRHJvcGRvd25NZW51IHtcbiAgICAgICAgY29uc3RydWN0b3IoZWxlbWVudCwgY29uZmlnKSB7XG4gICAgICAgICAgICB0aGlzLmNvbmZpZyA9IHRoaXMuX2dldENvbmZpZyhjb25maWcpO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICAgICAgICAgIHRoaXMuJGVsZW1lbnQgPSAkKHRoaXMuZWxlbWVudCk7XG4gICAgICAgICAgICB0aGlzLiRzY3JvbGxlciA9IHRoaXMuJGVsZW1lbnQuZmluZCgnLnNjcm9sbGVyJyk7XG4gICAgICAgICAgICB0aGlzLmlTY3JvbGw7XG4gICAgICAgICAgICB0aGlzLiR1bCA9IHRoaXMuJHNjcm9sbGVyLmZpbmQoJz4gdWwnKTtcbiAgICAgICAgICAgIHRoaXMuJGl0ZW1zID0gdGhpcy4kdWwuZmluZCgnPmxpJyk7XG4gICAgICAgICAgICB0aGlzLiRpdGVtc0Ryb3Bkb3ducyA9IHRoaXMuJGl0ZW1zLmZpbHRlcignLmRyb3Bkb3duJyk7XG4gICAgICAgICAgICB0aGlzLiRkcm9wZG93bk1lbnVzID0gdGhpcy4kaXRlbXNEcm9wZG93bnMuZmluZCgnLmRyb3Bkb3duLW1lbnUnKTtcbiAgICAgICAgICAgIHRoaXMuJGRyb3Bkb3duTWVudXNXcmFwcGVyO1xuICAgICAgICAgICAgdGhpcy4kc3RhcnRJdGVtID0gdGhpcy4kdWwuZmluZCgnbGk6ZXEoJyArIHRoaXMuY29uZmlnLnN0YXJ0QXRJdGVtICsgJyknKTtcbiAgICAgICAgICAgIHRoaXMuJGluZGljYXRvciA9IHRoaXMuJGVsZW1lbnQuZmluZCgnLmluZGljYXRvcicpO1xuXG4gICAgICAgICAgICB0aGlzLmluaXQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGluaXQoKSB7XG5cbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgdGhpcy4kaXRlbXNEcm9wZG93bnMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGl0ZW1JZCA9ICdpdGVtJyArICQodGhpcykuaW5kZXgoKTtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmRhdGEoJ2lkJywgaXRlbUlkKS5hdHRyKCdkYXRhLWlkJywgaXRlbUlkKTtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmZpbmQoJy5kcm9wZG93bi1tZW51JykuZGF0YSgncGFyZW50JywgaXRlbUlkKS5hdHRyKCdkYXRhLWlkJywgaXRlbUlkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy4kZHJvcGRvd25NZW51c1dyYXBwZXIgPSAkKCc8ZGl2IGNsYXNzPVwiaVNjcm9sbERyb3Bkb3duTWVudS1kcm9wZG93bnNcIj48L2Rpdj4nKTtcbiAgICAgICAgICAgIHRoaXMuJGVsZW1lbnQuYWZ0ZXIodGhpcy4kZHJvcGRvd25NZW51c1dyYXBwZXIpO1xuICAgICAgICAgICAgdGhpcy4kZHJvcGRvd25NZW51c1dyYXBwZXIuYXBwZW5kKHRoaXMuJGRyb3Bkb3duTWVudXMpO1xuXG4gICAgICAgICAgICB0aGlzLiRkcm9wZG93bk1lbnVzLmZpbmQoJ1tkYXRhLXRvZ2dsZT1jbG9zZV0nKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5jbG9zZXN0KCcuZHJvcGRvd24tbWVudScpLnNsaWRlVXAoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIFRpbWVvdXQgcmVxdWlyZWQgdG8gYXZvaWQgYnVncyB3aXRoIGlTY3JvbGwgbGF0ZSBpbml0aWFsaXphdGlvbi4uLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBzZWxmLiRzY3JvbGxlci53aWR0aChzZWxmLmdldEl0ZW1zV2lkdGgoKSk7XG4gICAgICAgICAgICAgICAgc2VsZi5pU2Nyb2xsID0gbmV3IElTY3JvbGwoc2VsZi5lbGVtZW50LCB7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50UGFzc3Rocm91Z2g6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbFg6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbFk6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBwcmV2ZW50RGVmYXVsdDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGJvdW5jZUVhc2luZzogJ3F1YWRyYXRpYycsXG4gICAgICAgICAgICAgICAgICAgIHNuYXA6IGZhbHNlLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHNlbGYuaVNjcm9sbC5zY3JvbGxUb0VsZW1lbnQoc2VsZi4kc3RhcnRJdGVtLmdldCgwKSwgMTI1KTtcbiAgICAgICAgICAgICAgICBzZWxmLnRvZ2dsZUluZGljYXRvcigpO1xuICAgICAgICAgICAgICAgICQod2luZG93KS5vbigncmVzaXplJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnRvZ2dsZUluZGljYXRvcigpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgc2VsZi5pbmRpY2F0b3JMb29wQW5pbWF0aW9uKDEwLCA1MDApO1xuICAgICAgICAgICAgICAgIHNlbGYuaVNjcm9sbC5vbignc2Nyb2xsU3RhcnQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuJGluZGljYXRvci5mYWRlT3V0KCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCA1MDApO1xuXG4gICAgICAgICAgICB0aGlzLiRpdGVtcy5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJCh0aGlzKS5maW5kKCc+IGEnKS50cmlnZ2VyKCdjbGljaycpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLiRpdGVtcy5maW5kKCc+IGEnKS5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIHNlbGYuJGRyb3Bkb3duTWVudXNXcmFwcGVyLmZpbmQoJ2RpdicpLmhpZGUoKTtcbiAgICAgICAgICAgICAgICB2YXIgJGxpUGFyZW50ID0gJCh0aGlzKS5wYXJlbnQoJ2xpJyk7XG4gICAgICAgICAgICAgICAgc2VsZi5pU2Nyb2xsLnNjcm9sbFRvRWxlbWVudCgkbGlQYXJlbnQuZ2V0KDApLCA1MDApO1xuICAgICAgICAgICAgICAgIHNlbGYuJGl0ZW1zLnJlbW92ZUNsYXNzKCdiZWZvcmVBY3RpdmUnKTtcbiAgICAgICAgICAgICAgICBzZWxmLiRpdGVtcy5ub3QoJGxpUGFyZW50KS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgJGxpUGFyZW50LnByZXYoKS5hZGRDbGFzcygnYmVmb3JlQWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgJGxpUGFyZW50LmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICAgICBpZiAoJGxpUGFyZW50Lmhhc0NsYXNzKCdkcm9wZG93bicpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpdGVtSWQgPSAkbGlQYXJlbnQuZGF0YSgnaWQnKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi4kZHJvcGRvd25NZW51c1dyYXBwZXIuZmluZCgnZGl2W2RhdGEtaWQ9JyArIGl0ZW1JZCArICddJykuc2xpZGVEb3duKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9IHRoaXMuaHJlZjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9XG5cbiAgICAgICAgdG9nZ2xlSW5kaWNhdG9yKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmlTY3JvbGwuaGFzSG9yaXpvbnRhbFNjcm9sbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuJGluZGljYXRvci5oaWRlKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuJGluZGljYXRvci5zaG93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpbmRpY2F0b3JMb29wQW5pbWF0aW9uKG9mZnNldCwgZHVyYXRpb24pIHtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuJGluZGljYXRvci5maW5kKCcuZmEnKS5hbmltYXRlKHtcbiAgICAgICAgICAgICAgICByaWdodDogJys9JyArIG9mZnNldFxuICAgICAgICAgICAgfSwgZHVyYXRpb24sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkKHRoaXMpLmFuaW1hdGUoe1xuICAgICAgICAgICAgICAgICAgICByaWdodDogJy09JyArIG9mZnNldFxuICAgICAgICAgICAgICAgIH0sIGR1cmF0aW9uLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaW5kaWNhdG9yTG9vcEFuaW1hdGlvbihvZmZzZXQsIGR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZ2V0SXRlbXNXaWR0aCgpIHtcbiAgICAgICAgICAgIHZhciBpdGVtc1dpZHRoID0gMDtcbiAgICAgICAgICAgIHRoaXMuJGl0ZW1zLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGl0ZW1zV2lkdGggKz0gJCh0aGlzKS5vdXRlcldpZHRoKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBpdGVtc1dpZHRoO1xuICAgICAgICB9XG5cbiAgICAgICAgX2dldENvbmZpZyhjb25maWcpIHtcbiAgICAgICAgICAgIGNvbmZpZyA9ICQuZXh0ZW5kKHt9LCBkZWZhdWx0cywgY29uZmlnKTtcbiAgICAgICAgICAgIHJldHVybiBjb25maWc7XG4gICAgICAgIH1cblxuICAgICAgICBzdGF0aWMgX2pRdWVyeUludGVyZmFjZShjb25maWcpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGxldCAkdGhpcyA9ICQodGhpcyk7XG4gICAgICAgICAgICAgICAgbGV0IGRhdGEgPSAkdGhpcy5kYXRhKERBVEFfS0VZKTtcbiAgICAgICAgICAgICAgICBsZXQgX2tpa29vID0gJC5leHRlbmQoe30sXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHRzLFxuICAgICAgICAgICAgICAgICAgICAkdGhpcy5kYXRhKCksXG4gICAgICAgICAgICAgICAgICAgIHR5cGVvZiBjb25maWcgPT09ICdvYmplY3QnICYmIGNvbmZpZ1xuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWRhdGEgJiYgL2Rpc3Bvc2UvLnRlc3QoY29uZmlnKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoIWRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IG5ldyBpU2Nyb2xsRHJvcGRvd25NZW51KHRoaXMsIF9raWtvbyk7XG4gICAgICAgICAgICAgICAgICAgICR0aGlzLmRhdGEoREFUQV9LRVksIGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgY29uZmlnID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YVtjb25maWddID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gbWV0aG9kIG5hbWVkIFwiJHtjb25maWd9XCJgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBkYXRhW2NvbmZpZ10oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAqIGpRdWVyeVxuICAgICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAqL1xuXG4gICAgJC5mbltOQU1FXSA9IGlTY3JvbGxEcm9wZG93bk1lbnUuX2pRdWVyeUludGVyZmFjZTtcbiAgICAkLmZuW05BTUVdLkNvbnN0cnVjdG9yID0gaVNjcm9sbERyb3Bkb3duTWVudTtcbiAgICAkLmZuW05BTUVdLm5vQ29uZmxpY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICQuZm5bTkFNRV0gPSBKUVVFUllfTk9fQ09ORkxJQ1Q7XG4gICAgICAgIHJldHVybiBpU2Nyb2xsRHJvcGRvd25NZW51Ll9qUXVlcnlJbnRlcmZhY2U7XG4gICAgfTtcbiAgICByZXR1cm4gaVNjcm9sbERyb3Bkb3duTWVudTtcbn0pKGpRdWVyeSk7XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2lTY3JvbGxEcm9wZG93bk1lbnUuanMiLCJtb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19wdWJsaWNfcGF0aF9fICsgXCJkZW1vLWJhc2ljLmNzc1wiO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2RlbW8tYmFzaWMuc2Nzc1xuLy8gbW9kdWxlIGlkID0gMVxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19wdWJsaWNfcGF0aF9fICsgXCJkZW1vLWludHJhbGlnbmVzLmNzc1wiO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2RlbW8taW50cmFsaWduZXMuc2Nzc1xuLy8gbW9kdWxlIGlkID0gMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19wdWJsaWNfcGF0aF9fICsgXCJkZW1vLXJoLmNzc1wiO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2RlbW8tcmguc2Nzc1xuLy8gbW9kdWxlIGlkID0gM1xuLy8gbW9kdWxlIGNodW5rcyA9IDAiLCJtb2R1bGUuZXhwb3J0cyA9IF9fd2VicGFja19wdWJsaWNfcGF0aF9fICsgXCJpU2Nyb2xsRHJvcGRvd25NZW51LmNzc1wiO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL2lTY3JvbGxEcm9wZG93bk1lbnUuc2Nzc1xuLy8gbW9kdWxlIGlkID0gNFxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9